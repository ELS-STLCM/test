@{
    Layout = null;
}
@{
    bool isPublished = ViewBag.assignmentStatus != null ? (bool)ViewBag.assignmentStatus : false;
}
<div class="clear clear-min-height-spacing">
    &nbsp;</div>
<div id="assignmentPreviewContent" class="div-with-border grid_32 assignment-preview-content vertical-content-scroll" style="width:784px;">
    <div class="grid_32 page-title">
        Step 5 of 5: Preview & Publish
    </div>
    <div class="grid_32 assignment-info">
        <div class="clear clear-min-height-spacing">
            &nbsp;</div>
        <div class="clear clear-min-height-spacing">
            &nbsp;</div>
        <div class="grid_5 header-text">
            Assignment Title:</div>
        <div class="grid_27">
            @ViewBag.assignmentName
        </div>
        <div class="clear clear-min-height-spacing">
            &nbsp;</div>
        <div class="grid_5 header-text">
            Modules:
        </div>
        <div class="grid_27">
            @ViewBag.Modules
        </div>
        <div class="clear clear-min-height-spacing">
            &nbsp;</div>
        <div class="grid_5 header-text">
            Keywords:
        </div>
        <div class="grid_27">
            @ViewBag.Keywords
        </div>
        <div class="clear clear-min-height-spacing">
            &nbsp;</div>
        <div class="grid_5 header-text">
            Duration:
        </div>
        <div class="grid_27">
            @ViewBag.Duration
        </div>
        <div class="clear clear-min-height-spacing">
            &nbsp;</div>
        <div class="grid_5 header-text">
            Patient:
        </div>
        <div class="grid_27">
            @ViewBag.Patient
        </div>
        <div class="clear clear-min-height-spacing">
            &nbsp;</div>
        <div class="clear clear-min-height-spacing">
            &nbsp;</div>
    </div>
    <div class="clear clear-min-height-spacing">
        &nbsp;</div>
    <div class="grid_32 header-text assignment-step5-header">
        Linked Skill Sets and Questions
    </div>
    <div class="clear clear-min-height-spacing">
        &nbsp;</div>
    <div id="divExpandCollapse">
        <a href="javascript:;" id="expandAll" class="link-color grid_4 select-hand">Expand All</a>
        <a href="javascript:;" id="collapseAll" class="link-color select-hand">Collapse All</a>
    </div>
    <div class="clear clear-min-height-spacing">
        &nbsp;</div>
    @Html.Partial("../../Views/Builder/Assignment/PreviewAndPublishAccordions")
</div>
<div class="clear clear-min-height-spacing">
    &nbsp;</div>
<div class="align-div-inline" id="backToStep4assignment">
    <div class="align-div-inline">
        <img alt="left" src="@Url.Content("~/Content/Images/Buttons/Button_left_curve_blue.jpg")" class="standard-height-for-buttons" /></div>
    <input type="submit" class="transaction-button align-div-inline standard-text standard-height-for-buttons"
        style="width: 60px;" onclick="backToStep4()" value="Back" id="btnBackToStep4" />
    <div class="align-div-inline">
        <img alt="right" src="@Url.Content("~/Content/Images/Buttons/Button_right_curve_blue.jpg")" class="standard-height-for-buttons" /></div>
</div>
<div class="prefix_10 align-div-inline" id="previewStep5assignment">
    <div class="align-div-inline">
        <img alt="left" src="@Url.Content("~/Content/Images/Buttons/Button_left_curve_blue.jpg")" class="standard-height-for-buttons" id="btnPreviewLeftCurve"/></div>
    <input type="submit" class="transaction-button align-div-inline standard-text standard-height-for-buttons"
        style="width: 60px;" value="Preview" id="btnPreviewAssignment" />
    <div class="align-div-inline">
        <img alt="right" src="@Url.Content("~/Content/Images/Buttons/Button_right_curve_blue.jpg")" class="standard-height-for-buttons" id="btnPreviewRightCurve"/></div>
</div>
<div class="grid_1 button-seperator">
    &nbsp;</div>
<div class="align-div-inline">
    <div class="align-div-inline">
        <img alt="left" src="@Url.Content("~/Content/Images/Buttons/Button_left_curve_blue.jpg")" class="standard-height-for-buttons" id="btnPublishAssignmentLeftCurve"/></div>
    <input type="submit" class="transaction-button align-div-inline standard-text standard-height-for-buttons"
        style="width: 60px;" value="Publish" id="btnPublishAssignment" />
    <div class="align-div-inline">
        <img alt="right" src="@Url.Content("~/Content/Images/Buttons/Button_right_curve_blue.jpg")" class="standard-height-for-buttons"  id="btnPublishAssignmentRightCurve"/></div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        $("#stepwiseImage").empty();
        $("#stepwiseImage").append("<img alt='' src='../../Content/Images/Buttons/step5AssignmentBuilder.PNG'/>");
        var isPublished = @isPublished.ToString().ToLower();
        if (isPublished) {
            assignment.previewPublish.publishedSettings();
        } 
        $("#btnPublishAssignment").click(function () {
            assignment.previewPublish.publish();
        });
        $("#btnBackToStep4").click(function () {
            assignment.previewPublish.backToStep4();
        });
        $("#btnPreviewAssignment").click(function () {
            assignment.previewPublish.preview();
        });
        $("#expandAll").click(function () {
            expandAllAccordions();
        });
        $("#collapseAll").click(function () {
            collapseAllAccordions();
        });
    });
    function backToStep4(){
        assignBuilder.redirectionFunctions.loadStep4OfAssignmentBuilder();
    }
</script>
